% camiregu 2024-jan-09
\chapter{Classifying Critical Points}

%----------------------------------------------------------------------------------------

\begin{theorem}[2nd Derivative Test]
    Let $f \in C^2(\Omega)$ and let $a \in \Omega (\Omega \subseteq \R^n)$ be a critical point of $f$.
    \begin{enumerate}
        \item If $H_f(a)$ is positive definite then $f$ has a local minimum at $a$.
        \item If $H_f(a)$ is negative definite then $f$ has a local maxiumum at $a$.
        \item If $H_f(a)$ is indefinite then $f$ has a saddle point at $a$.
    \end{enumerate}
\end{theorem}

\begin{recall}
    Any symmetric $n \times n$ matrix A can be diagonalized, i.e., $\exists$ an orthonormal basis $u_1, u_2, \dots, u_n$ in $\R^n$ and real numbers $\lambda_1, \lambda_2, \dots, \lambda_n$ such that $A u_i = \lambda_i u_i \forall i = 1, 2, \dots, n$.
\end{recall}

\begin{proposition}
    Let $Q$ be the quadratic form associated with an $n \times n$ symmetric matrix $A$. Then:
    \begin{enumerate}
        \item $Q$ is positive $\iff$ all the eigenvalues of $A$ are positive,
        \item $Q$ is negative $\iff$ all the eigenvalues of $A$ are negative,
        \item $Q$ is indefinite $\iff$ $A$ has both positive and negative eigenvalues.
    \end{enumerate}
\end{proposition}

\begin{corollary}
    Let $a$ be a critical point of a $C^2$ function $f: \Omega \to \R$. If $\det H_f(a) \neq 0$, then $f$ has either a local minimum or a local mximum or a saddle point at $a$.
\end{corollary}

\begin{definition}[degenerate critical points]
    A critical point $a$ of a $C^2$ function $f$ is called non-degenerate if $\det H_f(a) \neq 0$ and degenerate otherwise.
\end{definition}

\begin{example}[a degenerate critical point]
    When $f(x,y) = x^3$ then $(0,0)$ is a degenerate critical point of $f$, and $f$ has neither a local extremum at $(0,0)$ nor a saddle point.
\end{example}

\begin{definition}[the principal minors of a matrix]
    Let $A = (a_{ij})^n_{i,j=1}$ be an $n \times n$ matrix. Given $k = 1, 2, \dots, n$, we will denote by $A_k$ the $k \times k$ submatrix $A_k = (a_{ij})^k_{i,j=1}$. \\
    The determinants $\det A_k$ are called the \textbf{principal minors of A}.
\end{definition}

\begin{proposition}
    Let $A$ be a symmetric $n \times n$ matrix with $\det A \neq 0$. Then:
    \begin{enumerate}
        \item $A$ is positive definite $\iff$ $\det A_k > 0 \forall k = 1, 2, \dots, n$.
        \item $A$ is negative definite $\iff$ $(-1)^k \det A_k > 0 \forall k = 1, 2, \dots, n$.
        \item $A$ is indefinite $\iff$ $A$ is neither positive definite nor negative definite.
    \end{enumerate}
\end{proposition}

\begin{corollary}
    Let $A = \begin{bmatrix}\alpha & \beta \\ \beta & \gamma \end{bmatrix}$. Then:
    \begin{enumerate}
        \item A is positive definite $\iff$ $\alpha > 0$ and $\alpha \gamma - \beta^2 > 0$
        \item A is negative definite $\iff$ $\alpha < 0$ and $\alpha \gamma - \beta^2 > 0$
        \item A is indefinite $\iff$ $\alpha \gamma - \beta^2 < 0$
    \end{enumerate}
\end{corollary}

\begin{example}[classifying a critical point]
    We found that the function $f(x,y) = xye^{-x^2 - y^2}$ has 5 critical points: $\left(\pm \frac{1}{\sqrt{2}}, \pm \frac{1}{\sqrt{2}}\right)$, $\left(\pm \frac{1}{\sqrt{2}}, \mp \frac{1}{\sqrt{2}}\right)$, and $\left(0, 0\right)$, with an absolute maximum at $\left(\pm \frac{1}{\sqrt{2}}, \pm \frac{1}{\sqrt{2}}\right)$ and an absolute minimum at $\left(\pm \frac{1}{\sqrt{2}}, \mp \frac{1}{\sqrt{2}}\right)$. \\
    Investigate the nature of $(0,0)$,
    \begin{align*}
        \frac{\partial^2 f}{\partial x^2} &= \frac{\partial}{\partial x} \frac{\partial f}{\partial x} = \frac{\partial}{\partial x} \left[y(1 - 2x^2)e^{-x^2 - y^2}\right] = -4xye^{-x^2 - y^2} - 2xy(1-2x^2)e^{-x^2 - y^2} \\
        \frac{\partial^2 f}{\partial y^2} &= \frac{\partial}{\partial y} \left[x(1 - 2y^2)e^{-x^2 - y^2}\right] = -4xye^{-x^2 - y^2} - 2xy(1-2y^2)e^{-x^2 - y^2} \\
        \frac{\partial^2 f}{\partial x \partial y} &= (1 - 2y^2)e^{-x^2 - y^2} - 2x^2(1 - 2y^2)e^{-x^2 - y^2}
    \end{align*}
    So $H_f(0,0) = \begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix}$ is indefinite $\implies$ $f$ has a saddle point at (0,0).
\end{example}

\begin{example}[non-degenerate critical points]
    Find and classify the critical points of $f: \R^3 \to \R$ where $f(x,y,z) = x^3 - y^3 + 3xy + z^2 - 2z$. \\
    $\grad f = (3x^2 + 3y, -3y^2 + 3x, 2z - 2) = 0 \implies x^2 = -y, y^2 = x, z = 1 \implies x^2 = -y, x^4 = x, z = 1 \implies x^2 = -y, x=0$ or $x=1, z=1 \implies (x,y,z) = (0,0,1), (1,-1,1)$. \\
    So $(0,0,1)$ and $(1,-1,1)$ are the critical points.
    We have $H_f(x,y,z) = \begin{bmatrix}
        6x & 3 & 0 \\ 3 & -6y & 0 \\ 0 & 0 & 2
    \end{bmatrix}$, so $H_f(0,0,1) = \begin{bmatrix}
        0 & 3 & 0 \\ 3 & 0 & 0 \\ 0 & 0 & 2
    \end{bmatrix}$ is clearly indefinite since the first principal minor is $0$ and $H_f(1,-1,1) = \begin{bmatrix}
        6 & 3 & 0 \\ 3 & 6 & 0 \\ 0 & 0 & 2
    \end{bmatrix}$ is positive definite. \\
    So we have non-degenerate critical points (as $\det H_f \neq 0$). Hence, $(0,0,1)$ is a saddle point; $(1,-1,1)$ is a local minimum. \\
    But $f$ has no global extrema because $f(x,0,0) = x^3$ can take arbitrarily positive and negative values.
\end{example}

\begin{example}[a degenerate critical point]
    Let $f(x,y) = x^4 + y^4$ (with $(x,y) \in \R^2$). \\
    $\grad f = (4x^3, 4y^3) = 0 \iff (x,y) = (0,0)$. \\
    $H_f(x,y) = \begin{bmatrix}
        12x^2 & 0 \\ 0 & 12y^2
    \end{bmatrix}, H_f(0,0) = \begin{bmatrix}
        0 & 0 \\ 0 & 0
    \end{bmatrix}$. \\
    So $(0,0)$ is a degenerate critical point and the 2nd derivative test does not apply. However, $f$ has a global minimum at $(0,0)$.
\end{example}

\begin{theorem}[The inverse function theorem]
    Th. A. Let $I \subseteq \R$ be an interval and $f: I \to \R$ is a continuous injective function. Then:
    \begin{enumerate}
        \item $f$ is either strictly increasing or strictly decreasing.
        \item $f(I)$ is an interval containing the same number of endpoints as $I$.
        \item $f$ is a homeomorphism of $I$ onto $f(I)$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    \begin{enumerate}
        \item Let us first consider the case that $I = [a, b] (a < b)$. Since $f$ is injective, either $f(a) < f(b)$ or $f(b) < f(a)$. Assume that $f(a) < f(b)$ (the other case can be done symmetrically). Let's show that $f$ is strictly increasing on $[a,b]$, i.e., $f(x) < f(y)$ whenever $a \leq x < y \leq b$. We argue by contradiction, supposing that $f(x) > f(y)$ for some $a \leq x < y \leq b$. \\ 
        Note that $f(y) > f(a)$, for otherwise $f(y) < f(a) < f(b)$ and by the Intermediate Value Theorem (IVT), $\exists \alpha \in (y,b)$ such that $f(\alpha) = f(a)$, contradicting the injectivity of $f$. Therefore $f(a) < f(y) < f(x)$ and so, again, by the IVT $\exists y' \in (a,x)$ such that $f(y') = f(y)$, again contradicting the injectivity of $f$. \\
        Next, let $I$ be any interval. Pick up any $a, b \in I$ with $a < b$. Suppose that $f(a) < f(b)$ (the case $f(a) > f(b)$ can be done symmetrically). By the previous paragraph, we know that $f$ is strictly increasing on $[a,b]$. Now, if $x, y \in I$ and $x < y$, then with $\alpha = \min \{a, x\}, \beta = \max \{y, b\}$, we have $[a,b], [x, y] \subseteq [\alpha, \beta] \subseteq I$. \\
        Since $f$ is strictly increasing on $[a,b]$, we must have (using the 1st paragraph again) $f(\alpha) < f(\beta)$ and $f$ is strictly increasing on $[\alpha, \beta]$. Hence, we conclude that $f$ is strictly increasing on $I$.
        \item Since $f$ is continuous, $J = f(I)$ is an interval. Suppose that $f$ is strictly increasing. Note that the inverse function $f \inv$ is then also strictly increasing. \\
        Now, if $I$ contains its left endpoint $a$, then $\forall x \in I$, $f(a) \leq f(x)$, so $f(a)$ is a left endpoint of $J$. Similarly, if $I$ contains its right endpoint $b$, then $f(b)$ is the right endpoint of $J$. Applying the same argument with $f \inv$ in place of $f$, we conclude if $I$ contains its left (respectively, right) endpoint $c$, then $f \inv (c)$ is the left (respectively, right) endpoint of $I$. It follows that $I$ and $J$ contain the same number of endpoints.
        \item If $I = [a,b]$, then $f$ is a homeomorphism of $I$ onto $f(I)$ because of our general result about continuous injective functions on compact sets. \\
        Otherwise, it follows that $f \restr [a,b]$ is a homeomorphism onto $f([a,b])$ for any $a,b \in I$ with $a \leq b$. This implies that $f \inv: f(I) \to I$ is continuous (at any $y \in f(I)$). \\
        Indeed, let $y \in f(I)$ and consider any sequence $(y_n)$ in $f(I)$ with $y_n \to y$. Then the set $S = \{y\} \cup \{y_n: n \in N\}$ is compact, so it has both a smallest element $c = f(a)$ and a largest element $d = f(b)$. Assuming that $f$ is strictly increasing we must have $a \leq b$, and $f([a,b]) = [c,d] \supseteq S$. Since $f \restr [a,b]$ is a homeomorphism onto $[c,d]$ (i.e., $(f \restr [a,b])\inv = f\inv \restr [c,d]$ is continuous), we obtain $f \inv (y_n) = (f \inv \restr [c,d])(y_n) \to (f \inv \restr [c,d])(y) = f \inv (y)$. It follows that $f \inv$ is continuous at any $y \in f(I)$.
    \end{enumerate}
\end{proof}